<!doctype html>
<html lang="en">
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Today’s Horse Racing Picks</title>
<style>
  body{font-family:system-ui,Segoe UI,Roboto,Arial;margin:24px;max-width:900px}
  .race{border:1px solid #ddd;border-radius:8px;padding:12px;margin:12px 0}
  .race h2{margin:0 0 8px 0}
  .pick{padding:6px 8px;border-left:4px solid #ccc;margin:6px 0}
  .high{border-color:#4caf50}.medium{border-color:#ffa000}
  .meta{color:#666;font-size:12px}
</style>
<h1>Today’s Horse Racing Picks</h1>
<p class="meta" id="stamp"></p>
<div id="root">Loading…</div>
<script>
(async () => {
  const res = await fetch('./latest.json', {cache:'no-store'});
  if (!res.ok) { document.getElementById('root').textContent = 'No data.'; return; }
  const data = await res.json();
  document.getElementById('stamp').textContent =
    `Model: ${data.model} • Generated: ${new Date(data.generated_at).toLocaleString()}`;

  const root = document.getElementById('root'); root.innerHTML = '';
  for (const r of data.races) {
    const div = document.createElement('div'); div.className = 'race';
    div.innerHTML = `<h2>${r.course} — ${r.time}</h2>
      <div class="meta"><a href="${r.url}" target="_blank" rel="noopener">Racecard</a></div>`;
    if (!r.shortlist?.length) {
      div.innerHTML += `<p>No shortlisted picks.</p>`;
    } else {
      for (const p of r.shortlist) {
        const conf = (p.confidence||'').toLowerCase();
        div.innerHTML += `<div class="pick ${conf.includes('high')?'high':conf.includes('medium')?'medium':''}">
          <strong>${p.name}</strong> — ${p.rationale || ''}<br/>
          <span class="meta">
            ${p.jockey?`J: ${p.jockey} • `:''}${p.trainer?`T: ${p.trainer} • `:''}${p.form?`F: ${p.form} • `:''}${p.odds_note||''}
          </span>
        </div>`;
      }
    }
    root.appendChild(div);
  }
})();
</script>
</html>
